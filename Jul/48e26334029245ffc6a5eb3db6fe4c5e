An air strike hit a detention centre for mainly African migrants in a suburb of the Libyan capital of Tripoli late on Tuesday, killing at least 40 people and wounding 80, a health official said. It was the highest publicly reported toll from an air strike or shelling since eastern forces loyal to Khalifa Haftar launched an offensive three months ago with ground troops and aircraft to take the capital, base of Libya's internationally recognised government. Libya is a main departure point for migrants from Africa fleeing poverty and war and trying to reach Italy by boat, but many are picked up and brought back by the Libyan coast guard, supported by the European Union. Thousands are held in government-run detention centres in what human rights groups and the United Nations say are often inhuman conditions. The UNHCR refugee agency had already called in May for the Tajoura centre, which holds 600 people, to be evacuated after a projectile landed less than 100 metres away, injuring two migrants. Photos published on Tuesday showed African migrants undergoing surgery in a hospital after the strike. Others lay on beds, some covered in dust or with bandaged limbs. Malek Mersek, spokesman for a state emergency medical service, said 40 people had been killed and 80 wounded in the strike on the detention centre, which stands next to a military camp. The U.N. refugee agency said at least 30 migrants had died and dozens were injured, but that the death toll could rise. It could not confirm who had launched the attack. Tajoura, east of Tripoli's centre, is home to several camps belonging to forces allied to the internationally recognised government, which have been targeted by air strikes for weeks. HAFTAR ASSAULT ON TRIPOLI Haftar's Libyan National Army (LNA), allied to a parallel government based in eastern Libya, has seen its advance on Tripoli held up on the outskirts of the capital, and said it would start heavy air strikes after "traditional means" of war had been exhausted. His attempt to capture Tripoli has derailed U.N. attempts to broker an end to the chaos that has prevailed in the oil- and gas-producing country since the violent NATO-backed overthrow of Muammar Gaddafi in 2011. UNHCR chief Filippo Grandi tweeted that he had three messages concerning the detained migrants: "They must NOT be detained; civilians must NOT be a target; Libya is NOT a safe place of return. And of course, states with influence must cooperate to end conflict, rather than fuel it." In a statement, the Tripoli-based government blamed the "war criminal Khalifa Haftar" for the incident. The chairman of the African Union Commission, Moussa Faki Mahamat, demanded an immediate ceasefire and an independent investigation "to ensure that those responsible for this horrific crime of innocent civilians be brought to account". An LNA official denied that his force had hit the detention centre, saying that militias allied to Tripoli had shelled it after a precision air strike by the LNA on a military camp. The LNA air campaign has failed to take Tripoli in three months of fighting, and last week lost its main forward base in Gharyan to Tripoli's forces. Both sides enjoy military support from regional powers. The LNA has been supplied for years by the United Arab Emirates and Egypt, while Turkey recently shipped arms to Tripoli to stop Haftar's assault, diplomats say. The conflict threatens to disrupt oil supplies, boost migration across the Mediterranean to Europe, scupper U.N. plans for an election to end the rivalry between the parallel administrations in east and west - and create a security void that Islamist militants could fill.